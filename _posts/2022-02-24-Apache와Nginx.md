---

title: Apache와 Nginx
categories: [서버]
tags: [서버, apache, nginx]     # TAG names should always be lowercase
author:
name: Choi Jin Kyu
link: https://github.com/hmcck27
toc: true
# date: 2022-02-05

img_path: /assets/img/mdImage/

---

# Apache VS Nginx

최근에 서비스를 릴리즈할 날이 다가오고 있어서 포스트를 작성을 많이 못했다.  
흔히 백엔드 서버를 구성할때 어떤 종류의 서버를 사용하지 고민이 있을 수 있다.  
뭐 사실 난 nginx만 사용해봤는데,  
이번에 nginx를 깔면서 든 의문이 있었다.  

nginx와 apache는 무엇이 다르길래 최근에 죄다 nginx를 사용하는 걸까 ?  

사실 nginx를 위주로 많이 사용했던 나에게 apache라는 서버는 많이 들어는 봤지만 아예 생소한 개념이었다.  

그래서 이번에 apache와 nginx의 차이점을 한번 정리해보고자 한다.  

---

## 웹 서버

일단은 apache나 nginx나 둘다 웹 서버이다.  
웹 서버가 뭐하는 친구일까 ?  

웹 서버는 사용자의 브라우저에 페이지나 소스를 내려주는 역할을 한다.  
주로 정적인 데이터를 처리한다.  

그냥 예시를 한번 들어보자.  

우리가 웹 서비스를 만들어서 실제로 배포한다고 가정해보자.  

많은 사람들이 흔히 사용하는 AWS의 ec2 인스턴스를 하나 구독했다.  

ec2 인스턴스는 그냥 하나의 컴퓨터라고 보면 된다. 대신 네트워크에 연결되어 있는 컴퓨터.  

자 우리는 컴퓨터를 하나 샀다.  

이 컴퓨터가 네트워크에 연결되어 있다고 해서, 이 컴퓨터에 뭔가 요청을 보내면 응답이 올까 ?  

궁금하면 당장 집 노트북 ip로 해서 아무거나 쏴보자...
당연히 아무것도 안온다.  
우리는 배포를 하지 않았다.  

무언가 요청을 보냈을때 해당 요청을 받고, 복작복작 작업해서 작업물을 다시 요청자에게 리턴해주는 역할을 할 프로그램이 필요하다.  

그게 웹 서버다.  

그래서 우리는 ec2에 웹서버인 nginx를 깔았다.  

자 이제 요청을 보내면 뭐가 올까 ?  

당연히 에러 페이지만 온다. 아마 nginx 에러 페이지가 렌더링 될거다.  
당연하다. 요청은 받았는데, 복작복작 작업을 해서 결과물을 만들어 줄 친구가 없다.  

우리는 그 친구를 어플리케이션이라고 불른다.  
바로 흔하게 사용하는 백엔드 어플리케이션 예를 들면 스프링, 장고, 플라스크가 그 작업을 해준다.  

그래서 우리는 ec2에 스프링 war를 옮겨 넣었다.  
이제 스프링을 로드시키면 된다 !

근데 어떻게 스프링 어플레케이션을 로드하지 ? 
그냥 자바 파일 실행 ?

아니다. 자바 프로그램을 실행시킨다고 해보자.
프로세스는 하나만 떠있다.  

nginx로 요청은 받았는데 해당 요청을 자바 프로그램까지 옮기기 위해서는  
자바 서블릿을 사용한다.  

자바 서블릿을 누가 만들어 줄까 ?  

거기서 tomcat이 나온다.  

tomcat은 WAS라고 한다. Web application server.  

was는 웹 서버가 받은 요청을 전달 받아서 자바 서블릿으로 만든후 스프링 어플리케이션으로 전달한다.  

그럼 우리는 요청이 들어오고 요청을 처리하는 하나의 라이프 사이클을 이제 알 수 있다. 

컴퓨터 - 웹 서버 - 웹 어플리케이션 서버 - 어플리케이션

얘기가 길어졌는데, 웹 서버가 없으면 아무것도 못한다.  

이 웹서버에는 크게 두가지 종류가 있다. apache와 nginx.  

> 어 근데 웹 서버는 정적인 리소스를 처리한다고 했는데...? 실제 서버는 다양하게 내려줘야 하잖아 ?  
> -> 동적인 데이터를 다루는 것은 was + application이 한다 !

---

## Apache

요청당 스레드를 처리하는 구조를 가진다.  
즉 하나의 요청의 하나의 스레드이다.  
많은 요청이 들어올 수록 메모리 사용량을 비례해서 증가한다.  

웹 서버는 여러 클라이언트에게서 요청을 받는다.  
당연히 각 요청마다 다르게 처리해줘야 하니 해당 요청마다 스레드를 생성해서 was로 넘겨주는 형태를 가지는게  
apache이다.  

아니 요청이 백만개 들어오면 ? 백만개의 스래드를 생성한다....  
그러면 메모리가 작살난다.  
그래서 요즘에는 많이 안쓰는 추세라고 한다.  

### MPM

MPM은 















