<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Spring 의존관계 (1)" /><meta property="og:locale" content="en" /><meta name="description" content="의존 관계" /><meta property="og:description" content="의존 관계" /><link rel="canonical" href="https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" /><meta property="og:url" content="https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" /><meta property="og:site_name" content="개복치의 개발 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-10T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring 의존관계 (1)" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"의존 관계","url":"https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/","@type":"BlogPosting","headline":"Spring 의존관계 (1)","dateModified":"2022-02-10T00:00:00+08:00","datePublished":"2022-02-10T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/"},"@context":"https://schema.org"}</script><title>Spring 의존관계 (1) | 개복치의 개발 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="개복치의 개발 블로그"><meta name="application-name" content="개복치의 개발 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/jk.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">개복치의 개발 블로그</a></div><div class="site-subtitle font-italic">공부한걸 기록하자 !</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hmcck27" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hmcck27','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Spring 의존관계 (1)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring 의존관계 (1)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/hmcck27">Choi Jin Kyu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-10 00:00:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 10, 2022, 12:00 AM +0800" >Feb 10</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2587 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><h1 id="의존-관계">의존 관계</h1><p>Spring에서는 의존관계를 잘 설정해야 한다.<br /> 사실 Spring에서는 규격으로 정해진 방법이 있다.<br /> 해당 방법을 사용하면 무탈하게 개발할 수는 있으나<br /> 다른 방법들도 존재한다.</p><p>Spring에서 어떻게 의존관계를 설정하는지 알아보기 전에<br /> 일단 의존관계가 무엇인지 부터 차근차근 알아보자.</p><hr /><h2 id="의존관계">의존관계<a href="#의존관계" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>한번 생각해보자.<br /> 내가 피자를 먹는다.<br /> 내가 피자를 먹을때마다 피자의 양은 줄을 것이다.<br /> 피자를 먹는 주체는 누구인가 ? 바로 “나”다.</p><p>하지만 객체지향의 세계에서는 이야기가 조금 다르다.<br /> 피자를 먹는 함수인 eatPizza는 나에게 있겠지만,<br /> eatPizza를 호출하면 피자가 스스로 자신의 양을 줄이는 함수를 호출한다.</p><p>코드로 살펴볼까 ?</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">I</span> <span class="o">{</span>

    <span class="c1">// 내 이름</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 내 피자</span>
    <span class="kd">private</span> <span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">;</span>

    <span class="c1">// 피자를 먹는 함수</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eatPizza</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        
        <span class="c1">// 피자의 내부 메소드인 eaten()을 호출한다. </span>
        <span class="n">pizza</span><span class="o">.</span><span class="na">eaten</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pizza</span> <span class="o">{</span>

    <span class="c1">// 남은 피자 조각 수</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">leftPiece</span><span class="o">;</span>

    <span class="c1">// 생성자 (항상 8개의 조각으로 초기화한다.)</span>
    <span class="kd">public</span> <span class="nf">Pizza</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">=</span> <span class="mi">8</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 피자를 먹으면 조각이 하나 준다. 남은 조각이 없으면 에러를 던진다.  </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eaten</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalAccessException</span><span class="o">(</span><span class="s">"No left Piece !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">-=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="no">I</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="no">I</span><span class="o">();</span>
        <span class="n">i</span><span class="o">.</span><span class="na">eatPizza</span><span class="o">();</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>만약 I라는 클래스에 pizza가 없다면 피자를 먹는 I(나)는 피자를 먹을 수 없다.<br /> 즉, I 클래스는 Pizza 클래스를 필요로 한다.</p><p>이렇게 I클래스가 eatPizza()를 호출하기 위해서는 pizza가 필요하다.<br /> 즉 pizza 객체를 I내부에 갖고 있어야 한다.<br /> 이런 경우에 우리는 <strong>I는 Pizza에 의존한다.</strong> 라고 표현한다.</p><hr /><h2 id="다형성과-dependency-inversion">다형성과 Dependency Inversion<a href="#다형성과-dependency-inversion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>우리가 애플리케이션을 만들때 많은 인터페이스 또는 추상화 객체를 사용한다.<br /> 위의 코드에도 인터페이스 또는 추상화 객체를 사용하지 않고 피자의 종류를 늘려보면 어떻게 될까</p><p>우리는 Combination 피자 또는 Potato Pizza를 먹을거다.<br /> 그리고 그 둘은 일반 피자보다 더 맛있어서 한번 먹을때마다 더 많은 조각을 먹게된다.</p><p>코드로 살펴보자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">I</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">CombinationPizza</span> <span class="n">pizza</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPizza</span><span class="o">(</span><span class="nc">CombinationPizza</span> <span class="n">pizza</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pizza</span> <span class="o">=</span> <span class="n">pizza</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eatPizza</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="n">pizza</span><span class="o">.</span><span class="na">eaten</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PotatoPizza</span><span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">leftPiece</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eaten</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalAccessException</span><span class="o">(</span><span class="s">"No left Piece !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">-=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CombinationPizza</span><span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">leftPiece</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eaten</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalAccessException</span><span class="o">(</span><span class="s">"No left Piece !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">-=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p>우리가 이렇게 코드를 작성하면 나중에 유지보수가 정말 힘들어 진다…<br /> 내가 Combination 을 먹다가 나중에 Potato로 바꾼다면 뒤에 나오는 로직을 직접 수정하게 될 수도 있고,<br /> 클래스에서 먹는 피자의 종류 타입도 바꿔주고 피자가 쓰인 코드를 일일히 다 찾아서 combination에서 potato로 수정해야 한다.</p><p>이런 현상을 방지하기 위해서 인터페이스와 추상화 객체가 있다.</p><p>객체지향 방법론에서 가장 유명한 단어인 SOLID라는 단어를 들어봤을 것이다.<br /> 거기서 가장 마지막 D는 Dependency inversion이다.</p><p>결국 위의 코드는 DI 규칙이 제대로 지켜지지 않았다.<br /> 다른 말로 설명하면 인터페이스와 추상화 객체를 적절하게 사용하지 않았다.</p><p>만약 내가 먹고 싶은 피자가 Combination이 아니라 Potato면 어떻게 될까..? 실제로 한번 해보자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">Spring.PotatoPizza</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">I</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">PotatoPizza</span> <span class="n">pizza</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPizza</span><span class="o">(</span><span class="nc">PotatoPizza</span> <span class="n">pizza</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pizza</span> <span class="o">=</span> <span class="n">pizza</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eatPizza</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="n">pizza</span><span class="o">.</span><span class="na">eaten</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>다음과 같이 일일히 코드를 수정해줘야 한다.</p><p>만약에 내가 제대로 피자집을 차려서 피자의 수가 몇십개가 된다면 ?? 매번 코드를 수정해야 하는 대 참사가 발생한다.</p><p>DI를 제대로 지키려면 다음과 같은 코드로 수정해야 한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">I</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPizza</span><span class="o">(</span><span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pizza</span> <span class="o">=</span> <span class="n">pizza</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eatPizza</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="n">pizza</span><span class="o">.</span><span class="na">eaten</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PotatoPizza</span> <span class="kd">extends</span> <span class="nc">Pizza</span><span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eaten</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalAccessException</span><span class="o">(</span><span class="s">"No left Piece !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">-=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CombinationPizza</span> <span class="kd">extends</span> <span class="nc">Pizza</span><span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eaten</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalAccessException</span><span class="o">(</span><span class="s">"No left Piece !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftPiece</span> <span class="o">-=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 상속을 통해서 해결할 수 있다.<br /> 이러면 Pizza 객체를 상속받은 다른 여러피자를 난 원할때마다 코드의 수정이 없이 먹을 수 있다.</p><p>위와 같은 코드가 DI를 제대로 지킨 코드라고 볼 수 있는데,</p><p>기존의 의존성을 역전해서, 더이상 I는 피자의 종류에 의존하지 않게 된다.<br /> 어떤 피자던 <strong>피자</strong>이기만 한다면 바꿀 수 있다.</p><p>이처럼 DI를 지키면서 프로그래밍을 하면 확장성이 높고 재사용성이 높은 코드를 작성할 수 있다.</p><p>이 과정을 정리하면, I는 Pizza라는 추상객체 또는 인터페이스에 의존한다.<br /> 하지만 Pizza를 상속받은 Potato와 Comvination 객체(구현체)는 I와 의존관계가 없다.<br /> I는 Potato와 Combination이라는 객체에 대해서 아예 모른다.</p><p>즉 추상화 객체 또는 인터페이스와의 의존관계만 만들어주면, 실제 구현체와는 의존관계의 정도가 낮아진다.<br /> 결합도가 낮아진다.<br /> 결합도 낮아지니까 다른 구현체를 추가해도 상관없다.</p><p>다시 의존관계로 돌아가자.</p><hr /><h2 id="의존관계-주입">의존관계 주입<a href="#의존관계-주입" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>의존관계를 주입한다는 건 무슨 말일까 ?<br /> 앞에서는 의존관계에 대해서 알아보았다.</p><p>의존관계 주입이라는 말은 런타임시에 오브젝트 사이에 만들어지는 의존관계를 의미한다.<br /> 런타임 전에는 I는 실제 런타임시 사용할 오브젝트 무엇인지 모른다.</p><p>의존관계 주입은 구체적인 의존 객체 여기서는 구현체(Combination, Potato)와 그것을 사용할 객체(I)를 런타임에 연결시켜주는 것을 의미한다.</p><p>위의 DI가 지켜지지 않은 코드에서는 개발자가 원하는대로 의존관계를 주입하기 힘들었다.<br /> I - Combination 에서 I - Potato로의 변경(주입) 을 하려면 다시 코드를 수정해야 했다.</p><p>개발자가 편하게 의존관계를 주입하는 코드는 DI를 지킨 밑의 코드다.</p><p>예시를 들어보자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">I</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nc">Pizza</span> <span class="nf">getPizza</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">pizza</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPizza</span><span class="o">(</span><span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pizza</span> <span class="o">=</span> <span class="n">pizza</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eatPizza</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="n">pizza</span><span class="o">.</span><span class="na">eaten</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IllegalAccessException</span> <span class="o">{</span>
        <span class="c1">// 의존관계를 주입하자.</span>

        <span class="no">I</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="no">I</span><span class="o">();</span>
        <span class="c1">// 처음에는 Combination으로</span>

        <span class="nc">CombinationPizza</span> <span class="n">combinationPizza</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CombinationPizza</span><span class="o">();</span>

        <span class="c1">// 의존관계 주입. I의 Pizza는 Combination으로.</span>
        <span class="n">i</span><span class="o">.</span><span class="na">setPizza</span><span class="o">(</span><span class="n">combinationPizza</span><span class="o">);</span>

        <span class="c1">// 피자 먹기</span>
        <span class="n">i</span><span class="o">.</span><span class="na">eatPizza</span><span class="o">();</span>

        <span class="c1">// 피자 몇 조각 남았니</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"combinationPizza left piece = "</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="na">getPizza</span><span class="o">().</span><span class="na">myLeftPiece</span><span class="o">());</span>

        <span class="c1">// 나중에는 Potato로.</span>
        <span class="nc">PotatoPizza</span> <span class="n">potatoPizza</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PotatoPizza</span><span class="o">();</span>

        <span class="c1">// 의존관계 주입. 이번에는 Potato로.</span>
        <span class="n">i</span><span class="o">.</span><span class="na">setPizza</span><span class="o">(</span><span class="n">potatoPizza</span><span class="o">);</span>

        <span class="c1">// 피자 먹기</span>
        <span class="n">i</span><span class="o">.</span><span class="na">eatPizza</span><span class="o">();</span>

        <span class="c1">// 피자 몇조각 남았니</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"potatoPizza left piece = "</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="na">getPizza</span><span class="o">().</span><span class="na">myLeftPiece</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 출력
     * combinationPizza left piece = 5
     * potatoPizza left piece = 6
     */</span>
<span class="o">}</span>
</pre></table></code></div></div><p>즉 메인 메소드에서 원하는대로 내가 먹을 피자를 변경하는 것이 의존관계를 외부에서 주입하는 것이다.<br /> 이러기 위해서 인터페이스와 추상화 객체를 적절하게 사용해야 한다.</p><p>왜냐면, 클래스 모델(I)만을 봤을때는 어떤 피자를 먹을지 드러나지 않는다.<br /> = 사실 어떤 피자던 먹을 수 있어야 한다.</p><p>위의 코드를 보자.<br /> 내가 먹을 피자의 종류를 굳이 I 클래스 내부의 변수와 메소드를 수정하지 않고도<br /> 수정할 수 있었다.</p><p>SOLID 원칙에서 DI를 지킨 코드지만 사실은 ORP도 지켰다. 다른 피자를 추가해도 해당 피자가 Pizza만 상속받으면 <strong>코드는 확장에는 열려있고 변경에는 닫혀있다.</strong></p><hr /><h2 id="의존관계-주입의-여러-방법">의존관계 주입의 여러 방법<a href="#의존관계-주입의-여러-방법" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>자바 의존관계 주입에는 여러 방법이 있다.</p><ol><li>setter<li>constructor<li>field</ol><p>위의 예시에는 1번 setter 형식을 사용해서 의존관계를 주입했다.</p><p>스프링을 하면서 의존관계 주입에는 생성자 패턴인 좋다라고 외웠다. 그 이유에 대해서는 큰 고찰이 없이 개발을 했었다.</p><p>다음에는 각 의존관계 주입의 방법들을 분석하고 비교해보자.<br /> 실제로 왜 생성자 패턴이 좋을지 검증해보자.</p><p>끝 !</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/spring/'>Spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >Spring</a> <a href="/tags/dependency-injection/" class="post-tag no-text-decoration" >Dependency Injection</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring 의존관계 (1) - 개복치의 개발 블로그&url=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring 의존관계 (1) - 개복치의 개발 블로그&u=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Spring 의존관계 (1) - 개복치의 개발 블로그&url=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spring-IoC(2)/">Spring IoC (2)</a><li><a href="/posts/Annotation/">Annotation</a><li><a href="/posts/DtoToMap/">Dto to Map, with naming convention</a><li><a href="/posts/DTO%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9B%EA%B8%B0/">controller 파라미터 map -> dto 변환과정</a><li><a href="/posts/%EB%B0%B1%EC%A4%80-14226/">백준 14226 이모티콘</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80/">인증/인가</a> <a class="post-tag" href="/tags/implementation/">implementation</a> <a class="post-tag" href="/tags/annotation/">Annotation</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/dependency-injection/">Dependency Injection</a> <a class="post-tag" href="/tags/ioc/">IoC</a> <a class="post-tag" href="/tags/jackson/">Jackson</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/"><div class="card-body"> <em class="timeago small" date="2022-02-11 00:00:00 +0800" >Feb 11</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring 의존관계 (2)</h3><div class="text-muted small"><p> Spring 의존관계 (2) 앞서 자바에서 의존관계를 어떻게 주입하는지, 또 의존관계를 어떻게 하면 추상화 객체와 인터페이스를 사용해서 확장에 유리하게 주입하는지 알아봤다. 의존관계 주입이라는 용어도 알아봤는데, 런타임시에 어떤 구현체와 관계를 맺을지 결정하는 것이다. 토비의 스프링에서는 의존관계 주입을 다음과 같이 설명한다. 클래스 모델...</p></div></div></a></div><div class="card"> <a href="/posts/SOLID%EC%99%80Spring/"><div class="card-body"> <em class="timeago small" date="2022-02-17 00:00:00 +0800" >Feb 17</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SOLID와 Spring</h3><div class="text-muted small"><p> 스프링 기초 스프링의 기술들 스프링의 기술을 다양하다. 가장 쉽게 접할 수 있는 Spring Framework, Spring Boot 부터 각기 필요한 기능들을 구현하고 싶을때 사용하는 Spring Security, Spring Data, Spring session, Spring Rest Docs, Spring Batch, Spring Cloud,...</p></div></div></a></div><div class="card"> <a href="/posts/singleton%EA%B3%BC-Spring/"><div class="card-body"> <em class="timeago small" date="2022-03-23 00:00:00 +0800" >Mar 23</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Singleton과 Spring</h3><div class="text-muted small"><p> Singleton Pattern 여기서 자바 싱글톤 = spring singleton을 예시로 생각해보자. Singleton은 어플리케이션 전역에서 하나만 존재하는 객체이다. 자바 JVM에서 딱 하나만 존재하는 객체 혹은 이런 디자인 패턴을 singleton이라고 한다. Singleton Design Pattern 클래스의 인스턴스가 딱 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spring-security(2)/" class="btn btn-outline-primary" prompt="Older"><p>spring security (2)</p></a> <a href="/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" class="btn btn-outline-primary" prompt="Newer"><p>Spring 의존관계 (2)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/hmcck27">Choi Jin Kyu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80/">인증/인가</a> <a class="post-tag" href="/tags/implementation/">implementation</a> <a class="post-tag" href="/tags/annotation/">Annotation</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/dependency-injection/">Dependency Injection</a> <a class="post-tag" href="/tags/ioc/">IoC</a> <a class="post-tag" href="/tags/jackson/">Jackson</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
