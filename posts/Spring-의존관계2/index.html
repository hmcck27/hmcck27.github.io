<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Spring 의존관계 (2)" /><meta property="og:locale" content="en" /><meta name="description" content="Spring 의존관계 (2)" /><meta property="og:description" content="Spring 의존관계 (2)" /><link rel="canonical" href="https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" /><meta property="og:url" content="https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" /><meta property="og:site_name" content="개복치의 개발 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-11T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring 의존관계 (2)" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Spring 의존관계 (2)","url":"https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/","@type":"BlogPosting","headline":"Spring 의존관계 (2)","dateModified":"2022-02-11T00:00:00+08:00","datePublished":"2022-02-11T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/"},"@context":"https://schema.org"}</script><title>Spring 의존관계 (2) | 개복치의 개발 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="개복치의 개발 블로그"><meta name="application-name" content="개복치의 개발 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/jk.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">개복치의 개발 블로그</a></div><div class="site-subtitle font-italic">공부한걸 기록하자 !</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hmcck27" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hmcck27','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Spring 의존관계 (2)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring 의존관계 (2)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/hmcck27">Choi Jin Kyu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-11 00:00:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 11, 2022, 12:00 AM +0800" >Feb 11</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2282 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="spring-의존관계-2">Spring 의존관계 (2)</h1><p>앞서 자바에서 의존관계를 어떻게 주입하는지, 또 의존관계를 어떻게 하면<br /> 추상화 객체와 인터페이스를 사용해서 확장에 유리하게 주입하는지 알아봤다.</p><p>의존관계 주입이라는 용어도 알아봤는데,<br /> 런타임시에 어떤 구현체와 관계를 맺을지 결정하는 것이다.</p><p>토비의 스프링에서는 의존관계 주입을 다음과 같이 설명한다.</p><ol><li>클래스 모델이나 코드에는 런타임시점의 의존관계가 드러나지 않는다. 그러기 위해서는 인터페이스에 의존해야 한다.<li>런타임 시점의 의존관계는 컨테이너나 팩토리같은 제 3의 존재가 결정한다. (Potato인지 Combination인지)<li>의존관계는 사용할 오브젝트에 대한 레퍼런스를 외부에서 제공해줌으로써 만들어진다.</ol><p>여기서 제 3의 존재는 Appication Context, Bean Factory, Ioc Container 를 의미한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nf">I</span><span class="o">()</span> <span class="o">{</span>
  <span class="nc">Pizza</span> <span class="n">pizza</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PotatoPizza</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>의 코드의 문제점은 런타임시에 어떤 구현체와 의존관계를 맺을지 이미 코드레벨에서 결정되어 있다는 점이다.<br /> 따라서 스프링에서는 IoC 방식을 사용해서 런타임 시점의 의존관계를 이미 보여주는 코드를 제거하고,<br /> 구현체가 아닌 인터페이스를 파라미터로 받는다.<br /> 그리고 해당 인터페이스의 구현체는 제 3의 존재가 결정한다.</p><p>다음과 같다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">Spring.Pizza</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">Spring.PotatoPizza</span><span class="o">;</span>

<span class="c1">// 런타임 시에 의존관계가 드러나지 않도록 한다.</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nf">I</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 제 3의 존재가 어떤 구현체와 의존관계를 맺을지 결정한다.</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nf">PizzaFactory</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="no">I</span> <span class="nf">i</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">i</span><span class="o">(</span><span class="nc">Pizza</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Pizza</span> <span class="nf">pizza</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PotatoPizza</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nf">I</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">I</span><span class="o">(</span><span class="nc">Pizza</span> <span class="n">pizza</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pizza</span> <span class="o">=</span> <span class="n">pizza</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>위와 같은 방식을 사용하면</p><ol><li>런타임시 의존관계가 들러나지 않고<li>제 3의 존재 PizzaFactory가 외부에서 의존관계를 결정한다..<li>그리고 PizzaFactory에서 생성자를 통해 의존관계를 주입힌다.</ol><p>위에서 의존관계를 결정하는 것을 컨테이너라고 부른다고 했다.<br /> 따라서 PizzaFactory는 DI Factory이다.</p><p>이제 스프링에서 어떻게 의존관계를 주입하고 또 가장 적절한 방법이 뭔지 알아보자.</p><p>스프링에서 의존관계 주입 방식은 총 4가지이다.</p><ol><li>필드 주입<li>setter 주입<li>일반 메소드 주입<li>생성자 주입</ol><p>4가지의 방법 전부 클래스 변수를 어떻게 설정하느냐에 따라 달렸다.</p><hr /><h2 id="필드-주입">필드 주입<a href="#필드-주입" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>필드에 바로 주입하는 방식이다.</p><ol><li>코드가 간결하다는 장점이 있다.<li>외부에서 변경이 불가능하다는 치명적인 단점이 있다.<li>테스트 코드나 config 클래스에서 주로 사용한다.</ol><p>필드 주입은 다음과 같다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderServiceImpl</span> <span class="kd">implements</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="cm">/**
     * 필드 주입
     */</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>
    
<span class="o">}</span>
</pre></table></code></div></div><p>다음과 같이 해당 클래스 변수를 선언하고 위에 어노테이션 @Autowired를 사용한다.<br /> @Autowired가 부은 변수에 의존 객체를 주입하게 된다.<br /> 해당 방법 같이 사용하면 어떤 문제가 있을까 ?</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">OrderServiceImpl</span> <span class="n">orderService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderServiceImpl</span><span class="o">();</span>
        
<span class="o">}</span>
</pre></table></code></div></div><p>위와 같은 코드에서 내가 원하는대로 OrderRepository를 주입할 수 없다는 치명적인 단점이 있다.<br /> 의존하는 객체가 바뀐다고 해도 변경하려면 직접 클래스의 코드를 수정해야 한다.</p><p>간결하지만 가장 큰 문제가 있는 코드가 될 수 있다.</p><hr /><h2 id="setter-주입">setter 주입<a href="#setter-주입" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>이전 포스트에서 작성한 의존관계 주입 코드가 setter를 이용한 의존관계 주입이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderServiceImpl</span> <span class="kd">implements</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="cm">/**
     * setter 주입
     */</span>
    <span class="kd">private</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>
    
    <span class="nd">@AutoWired</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOrderRepository</span><span class="o">(</span><span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderRepository</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">;</span>
    <span class="o">}</span>
    
<span class="o">}</span>
</pre></table></code></div></div><p>위와 같이 setter함수를 따로 만든다.<br /> 그리고 setter 함수 위에 @Autowired 어노테이션을 붙인다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">OrderServiceImpl</span> <span class="n">orderService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderServiceImpl</span><span class="o">();</span>
        <span class="n">orderService</span><span class="o">.</span><span class="na">setOrderRepository</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderRepository</span><span class="o">());</span>
<span class="o">}</span>
</pre></table></code></div></div><p>그러면 위와 같은 방식으로 외부에서 setter를 통해서 원하는 repository를 주입할 수 있다.<br /> setter함수는 public으로 언제나 열려있으니, 선택, 변경의 가능성이 있는 의존관계에 사용한다.</p><hr /><h2 id="생성자-주입">생성자 주입<a href="#생성자-주입" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>가장 마지막 방법인 생성자 주입이다.<br /> 실제로 스프링에서 가장 권고하는 방법이기도 하다.<br /> 코드로 살펴보고 왜 가장 좋은 방법이라고 하는지 그 이유도 알아보자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderServiceImpl</span> <span class="kd">implements</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="cm">/**
     * 생성자 주입
     */</span>
    <span class="kd">private</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">OrderServiceImpl</span><span class="o">(</span><span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderRepository</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>위와 같은 방식이 생성자 주입 방식이다.<br /> 외부에서는 어떻게 호출할까 ??</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">OrderServiceImpl</span> <span class="n">orderService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderServiceImpl</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderRepository</span><span class="o">());</span>
<span class="o">}</span>
</pre></table></code></div></div><p>다음과 같이 클래스를 생성할때 생성자에 파라미터로 원하는 repository를 넣는다.</p><p>그렇다면 왜 생성자 주입 방식이 가장 좋다는 것일까 ? 그 이유는 다음과 같다.</p><ol><li>생성자 호출시점에 딱 1번 의존관계가 결정된다.<br /> 실제로 개발을 하다보면 의존관계를 중간에 변경할 일은 거의 없다. 오히려 중간에 변경하면 문제가 될 수 있다.<br /> 따라서 딱 1번으로 주입을 제한시키는것이 안전하다. 객체 지향적으로도 변경에 닫혀있는 방식이다. 무엇보다 스프링 빈은 싱글톤이다. 값을 막 중간에 바꾸면 큰일난다.<li>테스트 코드 작성시 유리하다. 순수 자바 코드를 통해 스프링 단위 테스트를 진행한다고 가정하자. 테스트 코드가 spring 위에서 작동하지 않는다.<br /> 따라서 테스트 하려는 코드에 주입받은 객체의 함수를 실행하거나 한다면, NullPointerException이 뜰것이다.<br /> 만약에 생성자 패턴을 사용한다면, 컴파일 시점에 객체를 주입받을 수 있다.<br /> 그렇다고 setter를 사용하면 싱글톤 기반의 객체의 변수를 마음대로 바꿀 수 있게 된다.<li>순환 참조를 방지한다.<br /> 두개의 객체가 서로에 대해서 의존관계를 갖고 있다면 어떻게 될까 ? 생성자가 호출되는 시점(스프링 빈이 생성되는 시점)에서 에러를 발생시키기 때문에 훨씬 안전하다.<br /> 생성자가 아니라 필드 주입을 사용하면 무한하게 서로가 호출되는 상황이 발생한다.</ol><p>다음과 같은 이유로 생성자 주입 방식을 권장한다.</p><p>그리고 개발하다보면 불편하게 생성자를 다 만들 필요도 없어진다.<br /> 생성자 주입 방식으로 빠르고 간편하게 개발하는 방법이 있다.</p><p>Lombok과 final을 사용하면 다음과 같은 코드로 간편하게 생성자 주입 방식을 사용할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderServiceImpl</span> <span class="kd">implements</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="cm">/**
     * 생성자 주입
     */</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>

<span class="o">}</span>
</pre></table></code></div></div><p>위와 같은 방식으로 사용하면 아주 편하다.<br /> Lombok의 @RequiredArgsConstructor를 사용하면 자동으로 생성자를 만들어 주고,<br /> final을 통해서 컴파일 시점에 해당 객체가 있는지 확인한다.<br /> 또한 스프링에서는 생성자가 1개인 경우에 자동으로 @Autowired를 생략해도 되기때문에 아주 편하게 생성자 주입이 가능하다.</p><hr /><h2 id="정리">정리<a href="#정리" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>스프링의 의존관계 주입 종류에 대해서 알아보았다.<br /> 기계처럼 롬복 + final만 썼다가 이렇게 원리를 자세하게 정리하니까 아주 좋다.<br /> 또한 객체 지향은 도대체 어디까지 얽혀있는건가 하는 무서운 생각이 든다.</p><p>다음에는 오늘 포스트에서 썼던 키워드인 SOLID, IoC, Singleton 에 대해서 정리해볼 생각이다.</p><p>끝 !!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/spring/'>Spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >Spring</a> <a href="/tags/dependency-injection/" class="post-tag no-text-decoration" >Dependency Injection</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring 의존관계 (2) - 개복치의 개발 블로그&url=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring 의존관계 (2) - 개복치의 개발 블로그&u=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Spring 의존관계 (2) - 개복치의 개발 블로그&url=https://hmcck27.github.io/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%842/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spring-IoC(2)/">Spring IoC (2)</a><li><a href="/posts/Annotation/">Annotation</a><li><a href="/posts/DtoToMap/">Dto to Map, with naming convention</a><li><a href="/posts/DTO%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9B%EA%B8%B0/">controller 파라미터 map -> dto 변환과정</a><li><a href="/posts/%EB%B0%B1%EC%A4%80-14226/">백준 14226 이모티콘</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80/">인증/인가</a> <a class="post-tag" href="/tags/implementation/">implementation</a> <a class="post-tag" href="/tags/annotation/">Annotation</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/dependency-injection/">Dependency Injection</a> <a class="post-tag" href="/tags/ioc/">IoC</a> <a class="post-tag" href="/tags/jackson/">Jackson</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/"><div class="card-body"> <em class="timeago small" date="2022-02-10 00:00:00 +0800" >Feb 10</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring 의존관계 (1)</h3><div class="text-muted small"><p> 의존 관계 Spring에서는 의존관계를 잘 설정해야 한다. 사실 Spring에서는 규격으로 정해진 방법이 있다. 해당 방법을 사용하면 무탈하게 개발할 수는 있으나 다른 방법들도 존재한다. Spring에서 어떻게 의존관계를 설정하는지 알아보기 전에 일단 의존관계가 무엇인지 부터 차근차근 알아보자. 의존관계 한번 생각해보자. 내가 피자를 먹는다...</p></div></div></a></div><div class="card"> <a href="/posts/SOLID%EC%99%80Spring/"><div class="card-body"> <em class="timeago small" date="2022-02-17 00:00:00 +0800" >Feb 17</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SOLID와 Spring</h3><div class="text-muted small"><p> 스프링 기초 스프링의 기술들 스프링의 기술을 다양하다. 가장 쉽게 접할 수 있는 Spring Framework, Spring Boot 부터 각기 필요한 기능들을 구현하고 싶을때 사용하는 Spring Security, Spring Data, Spring session, Spring Rest Docs, Spring Batch, Spring Cloud,...</p></div></div></a></div><div class="card"> <a href="/posts/singleton%EA%B3%BC-Spring/"><div class="card-body"> <em class="timeago small" date="2022-03-23 00:00:00 +0800" >Mar 23</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Singleton과 Spring</h3><div class="text-muted small"><p> Singleton Pattern 여기서 자바 싱글톤 = spring singleton을 예시로 생각해보자. Singleton은 어플리케이션 전역에서 하나만 존재하는 객체이다. 자바 JVM에서 딱 하나만 존재하는 객체 혹은 이런 디자인 패턴을 singleton이라고 한다. Singleton Design Pattern 클래스의 인스턴스가 딱 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Spring-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%841/" class="btn btn-outline-primary" prompt="Older"><p>Spring 의존관계 (1)</p></a> <a href="/posts/%EA%B0%9D%EC%B2%B4-%EC%A7%80%ED%96%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D(1)/" class="btn btn-outline-primary" prompt="Newer"><p>객체 지향 프로그래밍 (1)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/hmcck27">Choi Jin Kyu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80/">인증/인가</a> <a class="post-tag" href="/tags/implementation/">implementation</a> <a class="post-tag" href="/tags/annotation/">Annotation</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/dependency-injection/">Dependency Injection</a> <a class="post-tag" href="/tags/ioc/">IoC</a> <a class="post-tag" href="/tags/jackson/">Jackson</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
